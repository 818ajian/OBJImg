<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>OBJImage</title>
	<style type="text/css">

		* {
			margin: 0;
			padding: 0;
			border: 0;
			outline: 0;
		}

	</style>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r81/three.min.js"></script>
	<script type="text/javascript" src="../build/objimage.js"></script>
	<script type="text/javascript">

		document.addEventListener("DOMContentLoaded", function(){

			var renderer = new THREE.WebGLRenderer({
				// antialias: true
			});

			renderer.setClearColor(0x000000, 1);

			renderer.setSize(window.innerWidth, window.innerHeight);
			renderer.setPixelRatio(window.devicePixelRatio);

			document.body.appendChild(renderer.domElement);

			var scene = new THREE.Scene();

			var camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);

			camera.position.set(0, 2.5, 3);

			var light = new THREE.DirectionalLight(0xFFFFFF, 2);

			light.position.set(0, 0, 1);

			scene.add(light);

			// MAGIC THINGS

			OBJImage.defineTHREE(THREE);

			var magicMesh = null;

			new OBJImage("models/lara/lara.obj", {
				onLoad: function( file ){

					// console.log("ON LOAD", file);

				},
				onParse: function( modelLibrary ){

					console.log("FROM", modelLibrary);

					magicMesh = new OBJImage.MeshGenerator(modelLibrary);

					// scene.add(magicMesh);

					var image = modelLibrary.toImage();

					image.style.position = "absolute";
					image.style.bottom = "0px";
					image.style.left = "0px";
					image.style.width = image.style.height = "100px";

					document.body.appendChild(image);

					new OBJImage(image, {
						onLoad: function( file ){

							// console.log("ON LOAD IMG", file);

						},
						onParse: function( modelLibrary ){

							// console.log("PARSED IMAGE");

						}
					});

				}
			});

			function update(){

				window.requestAnimationFrame(update);

				if( magicMesh != null ){

					magicMesh.rotateY(Math.PI / 180);

				};

				renderer.render(scene, camera);

			};

			window.requestAnimationFrame(update);

		}, false);

	</script>
</head>
<body></body>
</html>